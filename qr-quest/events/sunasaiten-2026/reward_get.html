<!DOCTYPE html>
<html lang="ja">
<head>
  <script src="event-config.js"></script>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>å‚åŠ è³ã®å—ã‘å–ã‚Š</title>
  <style>
    body{font-family:system-ui,-apple-system,"Segoe UI",Roboto,"Noto Sans JP",sans-serif;background:#fffaf2;margin:0;padding:24px;text-align:center;color:#3b2f1a}
    .card{max-width:620px;margin:0 auto;background:#fff;border:1px solid #eadfcf;border-radius:16px;padding:18px;box-shadow:0 10px 22px rgba(0,0,0,.08)}
    h1{margin:0 0 10px;font-size:1.25rem}
    p{margin:10px 0;line-height:1.7}
    .btn{display:block;width:100%;max-width:320px;margin:12px auto 0;padding:12px 14px;border:none;border-radius:12px;background:#4fa3ff;color:#fff;font-weight:900;font-size:1rem;cursor:pointer}
  </style>
</head>
<body>
  <div class="card">
    <h1>ğŸ å‚åŠ è³ã®å—ã‘å–ã‚Š</h1>
    <p id="msg">ç¢ºèªä¸­â€¦</p>
    <button class="btn" onclick="location.href='start.html'">ğŸ  ãƒ›ãƒ¼ãƒ ã¸å¸°ã‚‹</button>
  </div>

<script>
(function(){
  const msg = document.getElementById('msg');

  if(localStorage.getItem('started') !== 'true'){
    location.replace('need_start.html'); return;
  }

  // scannerãŒä¿å­˜ã—ãŸãƒ†ã‚­ã‚¹ãƒˆ
  const t =
    localStorage.getItem('reward_scan_text') ||
    localStorage.getItem('scan_text') ||
    localStorage.getItem('last_scan_text') ||
    '';

  // å‚åŠ è³ç”¨QRã‹ã©ã†ã‹ï¼ˆreward ã‚’å«ã‚€æƒ³å®šï¼‰
  const ok = (t && (t.includes('reward') || t.includes('REWARD')));

  if(!ok){
    msg.textContent = 'å‚åŠ è³ã‚²ãƒƒãƒˆç”¨QRãŒèª­ã¿å–ã‚Œã¦ã„ã¾ã›ã‚“ã€‚ã‚‚ã†ä¸€åº¦ãŠè©¦ã—ãã ã•ã„ã€‚';
    return;
  }

  // ç¢ºå®šï¼ˆäºŒé‡äº¤ä»˜é˜²æ­¢ï¼‰
  localStorage.setItem('reward_claimed','true');
  localStorage.setItem('reward_claimed_at', String(Date.now()));
  msg.textContent = 'âœ… å‚åŠ è³ã‚²ãƒƒãƒˆæ¸ˆã¿ã«ã—ã¾ã—ãŸï¼ä¿‚å“¡ã«ç¢ºèªã—ã¦ã‚‚ã‚‰ã£ã¦ãã ã•ã„ã€‚';
    setTimeout(()=>{ location.replace('reward_ok.html'); }, 250);

})();
</script>
</body>
</html>
